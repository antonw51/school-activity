name: Check grammer

on:
  workflow_dispatch:
  push:
    paths:
      - '**/*.md'

jobs:
  convert:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Find changes
        id: modified
        run: |
          git fetch origin main:main
          GITHUB_OUTPUT="files=$(git diff --name-only --diff-filter=d main~ main)"

      - name: List changes
        run: |
          echo ${{ steps.modified.outputs.files }}

      - name: Cancel on empty
        if: steps.modified.outputs.files == ''
        run: exit 1

      - name: Download Ltex
        if: steps.modified.outputs.files != ''
        run: |
          wget "https://github.com/valentjn/ltex-ls/releases/download/16.0.0/ltex-ls-16.0.0-linux-x64.tar.gz"
      
      - name: Install Ltex
        if: steps.modified.outputs.files != ''
        run: |
          tar -xf ltex-ls-16.0.0-linux-x64.tar.gz
      
      - name: Check files
        if: steps.modified.outputs.files != ''
        env:
          FILES: ${{ steps.modified.outpus.files }}
        run: $PWD/ltex-ls-16.0.0/bin/ltex-cli --verbose $FILES
          
